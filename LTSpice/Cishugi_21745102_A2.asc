Version 4
SHEET 1 3256 680
WIRE 32 -1648 -96 -1648
WIRE 32 -1616 32 -1648
WIRE -96 -1568 -96 -1648
WIRE -176 -1520 -224 -1520
WIRE 176 -1520 -16 -1520
WIRE 256 -1520 176 -1520
WIRE 304 -1520 256 -1520
WIRE 256 -1504 256 -1520
WIRE -176 -1472 -224 -1472
WIRE 0 -1472 -16 -1472
WIRE 176 -1472 176 -1520
WIRE -96 -1376 -96 -1424
WIRE 48 -1376 -96 -1376
WIRE 176 -1376 176 -1408
WIRE 176 -1376 48 -1376
WIRE 256 -1376 256 -1424
WIRE 256 -1376 176 -1376
WIRE -576 -1328 -752 -1328
WIRE 48 -1328 48 -1376
WIRE -864 -1312 -864 -1344
WIRE -608 -1312 -688 -1312
WIRE -608 -1296 -608 -1312
WIRE -688 -1264 -688 -1312
WIRE -752 -1248 -752 -1328
WIRE -720 -1248 -752 -1248
WIRE -1296 -1232 -1392 -1232
WIRE -1184 -1232 -1296 -1232
WIRE -1024 -1232 -1120 -1232
WIRE -992 -1232 -1024 -1232
WIRE -576 -1232 -576 -1328
WIRE -576 -1232 -656 -1232
WIRE -512 -1232 -576 -1232
WIRE 48 -1232 48 -1264
WIRE -864 -1216 -864 -1232
WIRE -720 -1216 -864 -1216
WIRE -864 -1200 -864 -1216
WIRE 896 -1200 672 -1200
WIRE 1184 -1200 976 -1200
WIRE -1296 -1184 -1296 -1232
WIRE -1024 -1184 -1024 -1232
WIRE -688 -1184 -688 -1200
WIRE -1152 -1152 -1152 -1168
WIRE 1184 -1136 1184 -1200
WIRE 1184 -1136 1040 -1136
WIRE -1840 -1104 -1888 -1104
WIRE -1296 -1104 -1296 -1120
WIRE -1024 -1104 -1024 -1120
WIRE -864 -1104 -864 -1120
WIRE -2032 -1088 -2080 -1088
WIRE -1936 -1088 -1984 -1088
WIRE -1888 -1088 -1888 -1104
WIRE 480 -1088 400 -1088
WIRE 592 -1088 560 -1088
WIRE 672 -1088 672 -1200
WIRE 752 -1088 672 -1088
WIRE 848 -1088 816 -1088
WIRE 80 -1072 80 -1104
WIRE -2032 -1008 -2032 -1088
WIRE -1984 -1008 -2032 -1008
WIRE -1936 -1008 -1936 -1088
WIRE -1888 -1008 -1936 -1008
WIRE -1072 -1008 -1152 -1008
WIRE 1040 -1008 1040 -1136
WIRE 1088 -1008 1040 -1008
WIRE -2080 -992 -2080 -1008
WIRE -1072 -992 -1072 -1008
WIRE -240 -992 -432 -992
WIRE 16 -992 -176 -992
WIRE 672 -992 672 -1088
WIRE 736 -992 672 -992
WIRE 1184 -992 1184 -1136
WIRE 1184 -992 1152 -992
WIRE 1232 -992 1184 -992
WIRE 80 -976 80 -992
WIRE 272 -976 80 -976
WIRE 400 -976 400 -1088
WIRE 400 -976 352 -976
WIRE 464 -976 400 -976
WIRE 848 -976 848 -1088
WIRE 848 -976 800 -976
WIRE 864 -976 848 -976
WIRE 960 -976 912 -976
WIRE 1088 -976 960 -976
WIRE 80 -960 80 -976
WIRE 592 -960 592 -1088
WIRE 592 -960 528 -960
WIRE 736 -960 592 -960
WIRE -1152 -944 -1152 -1008
WIRE 464 -944 400 -944
WIRE -1184 -928 -1232 -928
WIRE 16 -928 16 -992
WIRE 16 -928 -176 -928
WIRE 960 -928 960 -976
WIRE -1024 -912 -1120 -912
WIRE -976 -912 -1024 -912
WIRE -944 -912 -976 -912
WIRE -1408 -896 -1456 -896
WIRE -1280 -896 -1328 -896
WIRE -1184 -896 -1280 -896
WIRE -1152 -864 -1152 -880
WIRE 80 -864 80 -880
WIRE -976 -848 -976 -912
WIRE -176 -832 -176 -928
WIRE -128 -832 -128 -848
WIRE -128 -832 -176 -832
WIRE -112 -832 -128 -832
WIRE 960 -832 960 -864
WIRE 16 -816 16 -928
WIRE 16 -816 -64 -816
WIRE 400 -816 400 -944
WIRE 400 -816 16 -816
WIRE -2032 -800 -2096 -800
WIRE -592 -800 -640 -800
WIRE -432 -800 -432 -992
WIRE -432 -800 -512 -800
WIRE -400 -800 -432 -800
WIRE -272 -800 -320 -800
WIRE -128 -800 -272 -800
WIRE -112 -800 -128 -800
WIRE -1280 -784 -1280 -896
WIRE -1168 -784 -1280 -784
WIRE -1024 -784 -1024 -912
WIRE -1024 -784 -1088 -784
WIRE -128 -784 -128 -800
WIRE -272 -768 -272 -800
WIRE -2032 -752 -2032 -800
WIRE -1920 -752 -1952 -752
WIRE -976 -736 -976 -784
WIRE -272 -688 -272 -704
WIRE -1920 -656 -1968 -656
WIRE -1920 -608 -1968 -608
WIRE -1168 -512 -1360 -512
WIRE -912 -512 -1104 -512
WIRE -304 -480 -416 -480
WIRE 16 -480 -224 -480
WIRE -912 -448 -912 -512
WIRE -912 -448 -1104 -448
WIRE -48 -432 -80 -432
WIRE -992 -416 -1024 -416
WIRE -80 -384 -80 -432
WIRE -1024 -368 -1024 -416
WIRE -112 -368 -112 -384
WIRE -112 -368 -160 -368
WIRE -96 -368 -112 -368
WIRE -1104 -352 -1104 -448
WIRE -1056 -352 -1056 -368
WIRE -1056 -352 -1104 -352
WIRE -1040 -352 -1056 -352
WIRE 16 -352 16 -480
WIRE 16 -352 -48 -352
WIRE 144 -352 16 -352
WIRE -912 -336 -912 -448
WIRE -912 -336 -992 -336
WIRE -896 -336 -912 -336
WIRE -512 -336 -560 -336
WIRE -416 -336 -416 -480
WIRE -416 -336 -448 -336
WIRE -368 -336 -416 -336
WIRE -256 -336 -304 -336
WIRE -112 -336 -256 -336
WIRE -96 -336 -112 -336
WIRE -1472 -320 -1520 -320
WIRE -1360 -320 -1360 -512
WIRE -1360 -320 -1392 -320
WIRE -1328 -320 -1360 -320
WIRE -1200 -320 -1248 -320
WIRE -1056 -320 -1200 -320
WIRE -1040 -320 -1056 -320
WIRE -256 -320 -256 -336
WIRE -112 -320 -112 -336
WIRE 16 -320 16 -352
WIRE -1056 -304 -1056 -320
WIRE -80 -304 -80 -320
WIRE -1200 -288 -1200 -320
WIRE -1024 -272 -1024 -304
WIRE -160 -240 -160 -368
WIRE 16 -240 -160 -240
WIRE -256 -224 -256 -240
WIRE -1200 -208 -1200 -224
WIRE 16 -144 16 -160
WIRE 48 -144 16 -144
FLAG -1152 -1152 0
FLAG -1392 -1232 9V
IOPIN -1392 -1232 In
FLAG -992 -1232 5V
IOPIN -992 -1232 Out
FLAG -1296 -1104 0
FLAG -1024 -1104 0
FLAG -1072 -992 5V
IOPIN -1072 -992 Out
FLAG -1152 -864 0
FLAG -944 -912 Pulses
IOPIN -944 -912 Out
FLAG -976 -736 0
FLAG -992 -416 5V
IOPIN -992 -416 Out
FLAG -1024 -272 0
FLAG -48 -432 5V
IOPIN -48 -432 Out
FLAG -864 -1104 0
FLAG -864 -1344 5V
IOPIN -864 -1344 Out
FLAG -1520 -320 Stimulus
FLAG 48 -1232 0
FLAG -224 -1472 Pulses
IOPIN -224 -1472 Out
FLAG 32 -1616 0
FLAG -224 -1520 5V
IOPIN -224 -1520 Out
FLAG 304 -1520 VoutBeatPulses
IOPIN 304 -1520 Out
FLAG -688 -1184 0
FLAG -608 -1296 5V
IOPIN -608 -1296 Out
FLAG -896 -336 LPF_output
IOPIN -896 -336 Out
FLAG -560 -336 LPF_output
IOPIN -560 -336 Out
FLAG -1232 -928 Vref
IOPIN -1232 -928 Out
FLAG 48 -144 Vref
IOPIN 48 -144 Out
FLAG -256 -224 Vref
IOPIN -256 -224 Out
FLAG 144 -352 filtered_stimulus
FLAG -1456 -896 filtered_stimulus
FLAG -80 -304 0
FLAG 960 -832 0
FLAG 1232 -992 VoutRateAnalogue
IOPIN 1232 -992 Out
FLAG -512 -1232 Vref
IOPIN -512 -1232 Out
FLAG -640 -800 VoutBeatPulses
IOPIN -640 -800 Out
FLAG 80 -864 0
FLAG 80 -1104 5V
IOPIN 80 -1104 Out
FLAG -1200 -208 0
FLAG -272 -688 0
FLAG -2080 -992 0
FLAG -1840 -1104 Stimulus
FLAG -1920 -752 9V
IOPIN -1920 -752 Out
FLAG -2096 -720 0
FLAG -1920 -656 VoutBeatPulses
IOPIN -1920 -656 Out
FLAG -1920 -608 VoutRateAnalogue
IOPIN -1920 -608 Out
SYMBOL LM7805 -1152 -1216 R0
SYMATTR InstName U1
SYMBOL cap -1312 -1184 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL cap -1040 -1184 R0
SYMATTR InstName C2
SYMATTR Value 200µ
SYMBOL Comparators\\LT1018 -1152 -912 R0
SYMATTR InstName U2
SYMBOL cap -992 -848 R0
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res -1312 -912 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 80k
SYMBOL res -1072 -800 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1000k
SYMBOL res -1232 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 152E3
SYMBOL res -1376 -336 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 6.57E3
SYMBOL cap -1216 -288 R0
SYMATTR InstName C4
SYMATTR Value 220E-9
SYMBOL cap -1104 -528 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C5
SYMATTR Value 2.2E-6
SYMBOL Opamps\\opamp2 -1024 -400 R0
SYMATTR InstName U4
SYMATTR Value TL081
SYMBOL cap -448 -352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C6
SYMATTR Value 270E-9
SYMBOL res -272 -336 R0
SYMATTR InstName R11
SYMATTR Value 301k
SYMBOL Opamps\\opamp2 -80 -416 R0
SYMATTR InstName U5
SYMATTR Value TL081
SYMBOL res -880 -1328 R0
SYMATTR InstName R3
SYMATTR Value 1E06
SYMBOL res -880 -1216 R0
SYMATTR InstName R4
SYMATTR Value 1E06
SYMBOL cap -304 -352 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 270E-9
SYMBOL res -208 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 3.64E06
SYMBOL res 0 -336 R0
SYMATTR InstName R9
SYMATTR Value 948k
SYMBOL Digital\\dflop -96 -1568 R0
SYMATTR InstName A1
SYMATTR SpiceModel DFLOP Vhigh 5 Trise 10n
SYMBOL diode 192 -1408 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL res 240 -1520 R0
SYMATTR InstName R5
SYMATTR Value 2.904k
SYMBOL cap 32 -1328 R0
SYMATTR InstName C8
SYMATTR Value 100E-06
SYMBOL res 0 -256 R0
SYMATTR InstName R10
SYMATTR Value 49.9k
SYMBOL diode 848 -960 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N914
SYMBOL cap 944 -928 R0
SYMATTR InstName C9
SYMATTR Value 10µ
SYMBOL res 368 -992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 2E06
SYMBOL res 576 -1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 10E06
SYMBOL Opamps\\opamp2 -688 -1296 R0
SYMATTR InstName U3
SYMATTR Value TL081
SYMBOL res -304 -816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10E06
SYMBOL cap -288 -768 R0
SYMATTR InstName C10
SYMATTR Value 32.1n
SYMBOL cap -176 -1008 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C11
SYMATTR Value 321n
SYMBOL res -496 -816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 358E3
SYMBOL res 64 -1088 R0
SYMATTR InstName R15
SYMATTR Value 1.20264E04
SYMBOL res 64 -976 R0
SYMATTR InstName R16
SYMATTR Value 1E04
SYMBOL Opamps\\opamp -96 -880 R0
SYMATTR InstName U6
SYMBOL Opamps\\opamp 496 -1024 R0
SYMATTR InstName U9
SYMBOL diode 752 -1072 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N914
SYMBOL Opamps\\opamp 768 -1040 R0
SYMATTR InstName U7
SYMBOL res 992 -1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL Opamps\\opamp 1120 -1056 R0
SYMATTR InstName U10
SYMBOL voltage -1984 -1104 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -89 197 Left 2
WINDOW 0 -13 54 Left 2
SYMATTR Value PWL file=PWLinput.csv
SYMATTR InstName V1
SYMBOL voltage -1888 -1104 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -386 233 Left 2
WINDOW 0 -11 56 Left 2
SYMATTR Value SINE({sineOffset} {sineAmplitude} {sineFreq})
SYMATTR InstName V2
SYMBOL voltage -2080 -1104 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 3 160 Left 2
WINDOW 0 -13 55 Left 2
SYMATTR Value {dcAmplitude}
SYMATTR InstName V3
SYMBOL voltage -2096 -816 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -46 76 Left 2
WINDOW 0 -13 57 Left 2
SYMATTR Value 9
SYMATTR InstName V4
SYMBOL res -1936 -768 R90
WINDOW 0 -9 30 VBottom 2
WINDOW 3 34 56 VTop 2
SYMATTR InstName R_Sense1
SYMATTR Value 0.010
TEXT -1552 -1400 Left 2 ;ES Cishugi.,  21745102\nDC = 1.9 V\nHeart rate pk = 61.05  mV
TEXT -1176 -1344 Left 2 !.incl TL081.LIB
TEXT -1176 -1368 Left 2 !.incl TLC2272.LIB
TEXT -1176 -1392 Left 2 !.lib opamp.sub
TEXT -2080 -1152 Left 2 !.tran 0 {transtop} 0 {timestep}
TEXT -1952 -1200 Left 2 !.include E344cfg.txt
TEXT -2288 -1416 Left 2 ;Don't change these -- used for auto-assessments.\nYou may modify input files while developing.\nFor submission: \n  * Use only 9V supply \n  * Connect "Stimulus" to your input\n  * Connect "VoutXXXX" to your output signals.\n  * Only one label name per net.
TEXT -2280 -1200 Left 2 ;Config file:
TEXT -2280 -1152 Left 2 ;Analysis setup:
TEXT -2272 -776 Left 2 ;Battery
TEXT -2280 -1064 Left 2 ;Sensor-\nemulating \nstimulus
TEXT -2272 -640 Left 2 ;Assessed nets:\nConnect to your outputs
LINE Normal -1792 -1040 -1856 -1040 2
LINE Normal -1792 -896 -1792 -1040 2
LINE Normal -1808 -912 -1792 -896 2
LINE Normal -1792 -896 -1808 -912 2
LINE Normal -1776 -912 -1792 -896 2
LINE Normal -2128 -1040 -2112 -1040 2
LINE Normal -2128 -960 -2128 -1040 2
LINE Normal -2128 -944 -2128 -960 2
LINE Normal -2096 -944 -2128 -944 2
LINE Normal -2112 -960 -2096 -944 2
LINE Normal -2096 -944 -2112 -960 2
LINE Normal -2112 -928 -2096 -944 2
LINE Normal -1968 -976 -1968 -1024 2
LINE Normal -1856 -976 -1968 -976 2
LINE Normal -1856 -928 -1856 -976 2
LINE Normal -1872 -944 -1856 -928 2
LINE Normal -1856 -928 -1872 -944 2
LINE Normal -1840 -944 -1856 -928 2
LINE Normal -2304 -576 -2304 -1440 1
LINE Normal -1680 -1440 -1680 -576 1
LINE Normal -1680 -576 -2304 -576 1
LINE Normal -1680 -1440 -2304 -1440 1
